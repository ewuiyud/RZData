<Window x:Class="Views.EmbeddedCarbonCalculationView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:Views"
      mc:Ignorable="d" 
      MinHeight="600"  MinWidth="1000"
      MaxHeight="600"  MaxWidth="1000"
        
      Title="隐含碳计算">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="auto"/>
        </Grid.RowDefinitions>
        <Label Content="建材生成及运输碳计量" FontFamily="微软雅黑 light" FontSize="25" Margin="10,20,10,10"/>
        <StackPanel HorizontalAlignment="Right" Orientation="Vertical" VerticalAlignment="Bottom" Margin="0,0,10,0">
            <StackPanel Orientation="Horizontal"  HorizontalAlignment="Right" >
                <Label Content="总碳排量:" FontFamily="微软雅黑 light" FontSize="15" Margin="0,3" VerticalContentAlignment="Bottom"/>
                <Label Content="{Binding TotalCarbonEmissions}" FontFamily="微软雅黑 light" FontSize="15" Margin="0,3" VerticalContentAlignment="Bottom"/>
                <Label Content="tCO2e" FontFamily="微软雅黑 light" FontSize="15" Margin="0,3" VerticalContentAlignment="Bottom"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal">
                <Label Content="生产碳排量:" FontFamily="微软雅黑 light" FontSize="15" Margin="0,3" VerticalContentAlignment="Bottom"/>
                <Label Content="{Binding ProductionCarbonEmissions}" FontFamily="微软雅黑 light" FontSize="15" Margin="0,3" VerticalContentAlignment="Bottom"/>
            <Label Content="tCO2e" FontFamily="微软雅黑 light" FontSize="15" Margin="0,3" VerticalContentAlignment="Bottom"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal">
                <Label Content="运输碳排量:" FontFamily="微软雅黑 light" FontSize="15" Margin="0,3" VerticalContentAlignment="Bottom"/>
                <Label Content="{Binding TransportationCarbonEmissions}" FontFamily="微软雅黑 light" FontSize="15" Margin="0,3" VerticalContentAlignment="Bottom"/>
            <Label Content="tCO2e" FontFamily="微软雅黑 light" FontSize="15" Margin="0,3" VerticalContentAlignment="Bottom"/>
            </StackPanel>

        </StackPanel>
        <DataGrid Grid.Row="1" ItemsSource="{Binding EmbeddedCarbonCalcutionModels}" IsReadOnly="True" CanUserAddRows="False" FontSize="14"
                       FontFamily="微软雅黑 Light" Background="White" RowHeight="28" 
                      CanUserResizeColumns="False"
                  AutoGenerateColumns="False" Margin="20,20,20,10" Width="auto" CanUserSortColumns="False" ColumnHeaderHeight="40" RowHeaderWidth="0">
            <DataGrid.Columns>
                <DataGridTextColumn Header="序号" Binding="{Binding SerialNumber}"/>
                <DataGridTextColumn Header="材料名称" Binding="{Binding MaterialName}"/>
                <DataGridTextColumn Header="规格型号" Binding="{Binding SpecificationModel}"/>
                <DataGridTextColumn Header="材料类别" Binding="{Binding MaterialCategory}"/>
                <DataGridTextColumn Header="二级分类" Binding="{Binding SecondLevelCategory}"/>
                <DataGridTextColumn Header="数量" Binding="{Binding Quantity}"/>
                <DataGridTextColumn Header="单位" Binding="{Binding Unit}"/>
                <DataGridTextColumn Header="重量换算系数(vunit/Q)" Binding="{Binding WeightConversionCoefficient}"/>
                <DataGridTextColumn Header="材料单价(元)" Binding="{Binding MaterialUnitPrice}"/>
                <DataGridTextColumn Header="材料合价(元)" Binding="{Binding MaterialTotalPrice}"/>
                <DataGridTextColumn Header="碳排放量" Binding="{Binding CarbonEmission}"/>
                <DataGridTextColumn Header="重量(t)" Binding="{Binding Weight}"/>
                <DataGridTextColumn Header="运输距离" Binding="{Binding TransportationDistance}"/>
                <DataGridTextColumn Header="运输碳排放量" Binding="{Binding TransportationCarbonEmission}"/>
            </DataGrid.Columns>
        </DataGrid>
        <Button Grid.Row="2" Content="导出" Margin="0,0,20,10" Height="30" Width="100" HorizontalAlignment="Right" Command="{Binding ExportCommand}" VerticalAlignment="Center"/>
    </Grid>
</Window>
